<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Bayes++ Bayesian Filtering Classes: uLAPACK.hpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.8 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>uLAPACK.hpp</h1><a href="uLAPACK_8hpp.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">/*</span>
00002 <span class="comment"> * Bayes++ the Bayesian Filtering Library</span>
00003 <span class="comment"> * Copyright (c) 2002 Michael Stevens</span>
00004 <span class="comment"> * See accompanying Bayes++.htm for terms and conditions of use.</span>
00005 <span class="comment"> *</span>
00006 <span class="comment"> * $Header: /cvsroot/bayesclasses/Bayes++/BayesFilter/uLAPACK.hpp,v 1.4.2.1 2004/02/11 21:06:42 mistevens Exp $</span>
00007 <span class="comment"> * $NoKeywords: $</span>
00008 <span class="comment"> */</span>
00009 
00010 <span class="comment">/*</span>
00011 <span class="comment"> * uBLAS to LAPACK Interface</span>
00012 <span class="comment"> *  Very basic we only functions for information_root_filter supported</span>
00013 <span class="comment"> */</span>
00014 
00015 <span class="comment">/* Filter Matrix Namespace */</span>
00016 <span class="keyword">namespace </span>Bayesian_filter_matrix
00017 {
<a name="l00018"></a><a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK.html">00018</a> <span class="keyword">namespace </span>LAPACK {
00019 
<a name="l00020"></a><a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK_1_1rawLAPACK.html">00020</a> <span class="keyword">namespace </span>rawLAPACK {
00021     <span class="comment">// LAPACK routines as C callable functions</span>
00022     <span class="keyword">extern</span> <span class="stringliteral">"C"</span> {
00023 
00024     <span class="keywordtype">void</span> <a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK_1_1rawLAPACK.html#a0">dgeqrf_</a>(
00025             <span class="keyword">const</span> <span class="keywordtype">int</span> &amp; m,
00026             <span class="keyword">const</span> <span class="keywordtype">int</span> &amp; n,
00027             <span class="keywordtype">double</span> da[],
00028             <span class="keyword">const</span> <span class="keywordtype">int</span> &amp; lda,
00029             <span class="keywordtype">double</span> dtau[],
00030             <span class="keywordtype">double</span> dwork[],
00031             <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; ldwork,
00032             <span class="keywordtype">int</span>&amp; info);
00033     <span class="keywordtype">void</span> <a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK_1_1rawLAPACK.html#a1">sgeqrf_</a>(
00034             <span class="keyword">const</span> <span class="keywordtype">int</span> &amp; m,
00035             <span class="keyword">const</span> <span class="keywordtype">int</span> &amp; n,
00036             <span class="keywordtype">float</span> da[],
00037             <span class="keyword">const</span> <span class="keywordtype">int</span> &amp; lda,
00038             <span class="keywordtype">float</span> dtau[],
00039             <span class="keywordtype">float</span> dwork[],
00040             <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; ldwork,
00041             <span class="keywordtype">int</span>&amp; info);
00042 
00043     <span class="keywordtype">void</span> <a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK_1_1rawLAPACK.html#a2">dgetrs_</a>(
00044             <span class="keyword">const</span> <span class="keywordtype">char</span>&amp; transa,
00045             <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; n,
00046             <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; nrhs,
00047             <span class="keyword">const</span> <span class="keywordtype">double</span> da[],
00048             <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; lda,
00049             <span class="keywordtype">int</span> ipivot[],
00050             <span class="keywordtype">double</span> db[],
00051             <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; ldb,
00052             <span class="keywordtype">int</span>&amp; info);
00053     <span class="keywordtype">void</span> <a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK_1_1rawLAPACK.html#a3">sgetrs_</a>(
00054             <span class="keyword">const</span> <span class="keywordtype">char</span>&amp; transa,
00055             <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; n,
00056             <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; nrhs,
00057             <span class="keyword">const</span> <span class="keywordtype">float</span> da[],
00058             <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; lda,
00059             <span class="keywordtype">int</span> ipivot[],
00060             <span class="keywordtype">float</span> db[],
00061             <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; ldb,
00062             <span class="keywordtype">int</span>&amp; info);
00063 
00064     <span class="keywordtype">void</span> <a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK_1_1rawLAPACK.html#a4">dgetrf_</a>(
00065             <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; m,
00066             <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; n,
00067             <span class="keywordtype">double</span> da[],
00068             <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; lda,
00069             <span class="keywordtype">int</span> ipivot[],
00070             <span class="keywordtype">int</span>&amp; info);
00071     <span class="keywordtype">void</span> <a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK_1_1rawLAPACK.html#a5">sgetrf_</a>(
00072             <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; m,
00073             <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; n,
00074             <span class="keywordtype">float</span> da[],
00075             <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; lda,
00076             <span class="keywordtype">int</span> ipivot[],
00077             <span class="keywordtype">int</span>&amp; info);
00078 
00079     }<span class="comment">// extern "C"</span>
00080 
00081     <span class="comment">// Type overloads for C++</span>
<a name="l00082"></a><a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK_1_1rawLAPACK.html#a6">00082</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK_1_1rawLAPACK.html#a6">geqrf</a>( <span class="keyword">const</span> <span class="keywordtype">int</span> &amp; m, <span class="keyword">const</span> <span class="keywordtype">int</span> &amp; n, <span class="keywordtype">double</span> da[], <span class="keyword">const</span> <span class="keywordtype">int</span> &amp; lda, <span class="keywordtype">double</span> dtau[], <span class="keywordtype">double</span> dwork[], <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; ldwork, <span class="keywordtype">int</span>&amp; info)
00083     {
00084         <a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK_1_1rawLAPACK.html#a0">dgeqrf_</a>(m,n,da,lda,dtau,dwork,ldwork,info);
00085     }
<a name="l00086"></a><a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK_1_1rawLAPACK.html#a7">00086</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK_1_1rawLAPACK.html#a6">geqrf</a>( <span class="keyword">const</span> <span class="keywordtype">int</span> &amp; m, <span class="keyword">const</span> <span class="keywordtype">int</span> &amp; n, <span class="keywordtype">float</span> da[], <span class="keyword">const</span> <span class="keywordtype">int</span> &amp; lda, <span class="keywordtype">float</span> dtau[], <span class="keywordtype">float</span> dwork[], <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; ldwork, <span class="keywordtype">int</span>&amp; info)
00087     {
00088         <a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK_1_1rawLAPACK.html#a1">sgeqrf_</a>(m,n,da,lda,dtau,dwork,ldwork,info);
00089     }
<a name="l00090"></a><a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK_1_1rawLAPACK.html#a8">00090</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK_1_1rawLAPACK.html#a8">getrs</a>( <span class="keyword">const</span> <span class="keywordtype">char</span>&amp; transa, <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; n, <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; nrhs, <span class="keyword">const</span> <span class="keywordtype">double</span> da[], <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; lda, <span class="keywordtype">int</span> ipivot[], <span class="keywordtype">double</span> db[], <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; ldb, <span class="keywordtype">int</span>&amp; info)
00091     {
00092         <a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK_1_1rawLAPACK.html#a2">dgetrs_</a>(transa,n,nrhs,da,lda,ipivot,db,ldb,info);
00093     }
<a name="l00094"></a><a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK_1_1rawLAPACK.html#a9">00094</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK_1_1rawLAPACK.html#a8">getrs</a>( <span class="keyword">const</span> <span class="keywordtype">char</span>&amp; transa, <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; n, <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; nrhs, <span class="keyword">const</span> <span class="keywordtype">float</span> da[], <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; lda, <span class="keywordtype">int</span> ipivot[], <span class="keywordtype">float</span> db[], <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; ldb, <span class="keywordtype">int</span>&amp; info)
00095     {
00096         <a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK_1_1rawLAPACK.html#a3">sgetrs_</a>(transa,n,nrhs,da,lda,ipivot,db,ldb,info);
00097     }
<a name="l00098"></a><a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK_1_1rawLAPACK.html#a10">00098</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK_1_1rawLAPACK.html#a10">getrf</a>( <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; m, <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; n, <span class="keywordtype">double</span> da[], <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; lda, <span class="keywordtype">int</span> ipivot[], <span class="keywordtype">int</span>&amp; info)
00099     {
00100         <a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK_1_1rawLAPACK.html#a4">dgetrf_</a>(m,n,da,lda,ipivot,info);
00101     }
<a name="l00102"></a><a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK_1_1rawLAPACK.html#a11">00102</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK_1_1rawLAPACK.html#a10">getrf</a>( <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; m, <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; n, <span class="keywordtype">float</span> da[], <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; lda, <span class="keywordtype">int</span> ipivot[], <span class="keywordtype">int</span>&amp; info)
00103     {
00104         <a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK_1_1rawLAPACK.html#a5">sgetrf_</a>(m,n,da,lda,ipivot,info);
00105     }
00106 }<span class="comment">// namespace rawLAPACK</span>
00107 
00108 
00109 <span class="comment">/* Support types */</span>
<a name="l00110"></a><a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK.html#a0">00110</a> <span class="keyword">typedef</span> boost::numeric::ublas::vector&lt;int&gt; <a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK.html#a0">pivot_t</a>;
<a name="l00111"></a><a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK.html#a1">00111</a> <span class="keyword">typedef</span> <a class="code" href="namespaceBayesian__filter__matrix.html#a9">Bayesian_filter_matrix::DenseVec</a> <a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK.html#a1">vector_t</a>;
<a name="l00112"></a><a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK.html#a2">00112</a> <span class="keyword">typedef</span> <a class="code" href="namespaceBayesian__filter__matrix.html#a12">Bayesian_filter_matrix::DenseColMatrix</a> <a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK.html#a2">matrix_t</a>;
00113 
00114 <span class="comment">/* LAPACK Interface*/</span>
00115 
00116 
00117 
00118 <span class="comment">// QR Factorization of a MxN General Matrix A.</span>
00119 <span class="comment">//    a       (IN/OUT - matrix(M,N)) On entry, the coefficient matrix A. On exit , the upper triangle and diagonal is the min(M,N) by N upper triangular matrix R.  The lower triangle, together with the tau vector, is the orthogonal matrix Q as a product of min(M,N) elementary reflectors.</span>
00120 <span class="comment">//    tau     (OUT - vector (min(M,N))) Vector of the same numerical type as A. The scalar factors of the elementary reflectors.</span>
00121 <span class="comment">//    info    (OUT - int)</span>
00122 <span class="comment">//   0   : function completed normally</span>
00123 <span class="comment">//   &lt; 0 : The ith argument, where i = abs(return value) had an illegal value.</span>
<a name="l00124"></a><a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK.html#a3">00124</a> <span class="keywordtype">int</span> <a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK.html#a3">geqrf</a> (<a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK.html#a2">matrix_t</a>&amp; a, <a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK.html#a1">vector_t</a>&amp; tau)
00125 {
00126     <span class="keywordtype">int</span>              _m = int(a.size1());
00127     <span class="keywordtype">int</span>              _n = int(a.size2());
00128     <span class="keywordtype">int</span>              _lda = int(a.size1());
00129     <span class="keywordtype">int</span>              _info;
00130 
00131     <span class="comment">// make_sure tau's size is greater than or equal to min(m,n)</span>
00132     <span class="keywordflow">if</span> (int(tau.size()) &lt; (_n&lt;_m ? _n : _m) )
00133         <span class="keywordflow">return</span> -104;
00134 
00135     <span class="keywordtype">int</span> ldwork = _n*_n;
00136     <a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK.html#a1">vector_t</a> dwork(ldwork);
00137     <a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK.html#a3">rawLAPACK::geqrf</a> (_m, _n, a.data().begin(), _lda, tau.data().begin(), dwork.data().begin(), ldwork, _info);
00138 
00139     <span class="keywordflow">return</span> _info;
00140 }
00141 
00142 <span class="comment">// LU factorization of a general matrix A.  </span>
00143 <span class="comment">//    Computes an LU factorization of a general M-by-N matrix A using</span>
00144 <span class="comment">//    partial pivoting with row interchanges. Factorization has the form</span>
00145 <span class="comment">//    A = P*L*U.</span>
00146 <span class="comment">//    a       (IN/OUT - matrix(M,N)) On entry, the coefficient matrix A to be factored. On exit, the factors L and U from the factorization A = P*L*U.</span>
00147 <span class="comment">//    ipivot  (OUT - vector(min(M,N))) Integer vector. The row i of A was interchanged with row IPIV(i).</span>
00148 <span class="comment">//    info    (OUT - int)</span>
00149 <span class="comment">//   0   :  successful exit</span>
00150 <span class="comment">//   &lt; 0 :  If INFO = -i, then the i-th argument had an illegal value.</span>
00151 <span class="comment">//   &gt; 0 :  If INFO = i, then U(i,i) is exactly zero. The  factorization has been completed, but the factor U is exactly singular, and division by zero will occur if it is used to solve a system of equations.</span>
<a name="l00152"></a><a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK.html#a4">00152</a> <span class="keywordtype">int</span> <a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK.html#a4">getrf</a> (<a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK.html#a2">matrix_t</a>&amp; a, <a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK.html#a0">pivot_t</a>&amp; ipivot)
00153 {
00154     matrix_t::value_type* _a = a.data().begin();
00155     <span class="keywordtype">int</span> _m = int(a.size1());
00156     <span class="keywordtype">int</span> _n = int(a.size2());
00157     <span class="keywordtype">int</span> _lda = _m;  <span class="comment">// minor size</span>
00158     <span class="keywordtype">int</span> _info;
00159 
00160     <a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK.html#a4">rawLAPACK::getrf</a> (_m, _n,   _a, _lda, ipivot.data().begin(), _info);
00161 
00162     <span class="keywordflow">return</span> _info;
00163 }
00164 
00165 <span class="comment">// Solution to a system using LU factorization </span>
00166 <span class="comment">//   Solves a system of linear equations A*X = B with a general NxN</span>
00167 <span class="comment">//   matrix A using the LU factorization computed by GETRF.</span>
00168 <span class="comment">//   transa  (IN - char)  'T' for the transpose of A, 'N' otherwise.</span>
00169 <span class="comment">//   a       (IN - matrix(M,N)) The factors L and U from the factorization A = P*L*U as computed by GETRF.</span>
00170 <span class="comment">//   ipivot  (IN - vector(min(M,N))) Integer vector. The pivot indices from GETRF; row i of A was interchanged with row IPIV(i).</span>
00171 <span class="comment">//   b       (IN/OUT - matrix(ldb,NRHS)) Matrix of same numerical type as A. On entry, the right hand side matrix B. On exit, the solution matrix X.</span>
00172 <span class="comment">//</span>
00173 <span class="comment">//   info    (OUT - int)</span>
00174 <span class="comment">//   0   : function completed normally</span>
00175 <span class="comment">//   &lt; 0 : The ith argument, where i = abs(return value) had an illegal value.</span>
00176 <span class="comment">//   &gt; 0 : if INFO =  i,  U(i,i)  is  exactly  zero;  the  matrix is singular and its inverse could not be computed.</span>
<a name="l00177"></a><a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK.html#a5">00177</a> <span class="keywordtype">int</span> <a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK.html#a5">getrs</a> (<span class="keywordtype">char</span> transa, <a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK.html#a2">matrix_t</a>&amp; a,
00178         <a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK.html#a0">pivot_t</a>&amp; ipivot, <a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK.html#a2">matrix_t</a>&amp; b)
00179 {
00180     matrix_t::value_type* _a = a.data().begin();
00181     <span class="keywordtype">int</span> a_n = int(a.size1());
00182     <span class="keywordtype">int</span> _lda = a_n;
00183     <span class="keywordtype">int</span> p_n = int(ipivot.size());
00184 
00185     matrix_t::value_type* _b = b.data().begin();
00186     <span class="keywordtype">int</span> b_n = int(b.size1());
00187     <span class="keywordtype">int</span> _ldb = b_n;
00188     <span class="keywordtype">int</span> _nrhs = int(b.size2()); <span class="comment">/* B's size2 is the # of vectors on rhs */</span>
00189 
00190     <span class="keywordflow">if</span> (a_n != b_n) <span class="comment">/*Test to see if AX=B has correct dimensions */</span>
00191         <span class="keywordflow">return</span> -101;
00192     <span class="keywordflow">if</span> (p_n &lt; a_n)     <span class="comment">/*Check to see if ipivot is big enough */</span>
00193         <span class="keywordflow">return</span> -102;
00194 
00195     <span class="keywordtype">int</span> _info;
00196     <a class="code" href="namespaceBayesian__filter__matrix_1_1LAPACK.html#a5">rawLAPACK::getrs</a> (transa, a_n, _nrhs, _a,   _lda, ipivot.data().begin(), 
00197                 _b, _ldb, _info);
00198 
00199     <span class="keywordflow">return</span> _info;
00200 } 
00201 
00202 }<span class="comment">//namespace LAPACK</span>
00203 }<span class="comment">//namespace Bayesian_filter_matrix</span>
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Tue Jan 18 19:23:17 2005 for Bayes++ Bayesian Filtering Classes by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.8 </small></address>
</body>
</html>
